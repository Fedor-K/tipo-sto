# TIPO-STO - CRM для автосервиса

## Текущая архитектура

### Серверы
- **147.45.98.69** - TIPO-STO (FastAPI приложение)
  - SSH: Administrator / kFop??zSpU4QK-
  - Python 3.12 установлен
  - TIPO-STO работает на порту 8000
  - UI: http://147.45.98.69:8000/ui
  - Есть VPN подключение к Rent1C (адаптер 1CAAS, IP 172.22.138.80)

- **185.222.161.252** - Сервер 1С (API Gateway)
  - RDP: порт 6677
  - SSH: порт 22 (внешний доступ заблокирован хостером, только через RDP)
  - Логин: 22Linia1
  - Пароль: RhK312Sz1$
  - Python 32-bit: C:\Python312-32\python.exe
  - 1С база: D:\Base (Администратор / 12345678)
  - API Gateway: C:\temp\api_gw.py (порт 8080)

### Rent1C (облачная 1С)
- Аккаунт: 1R96614U1 / X7gDhIChmV
- Сервер: rca-farm-01.1c-hosting.com
- База: 1R96614_AVTOSERV30_4pgnl9opb4
- Веб-доступ: http://172.22.0.89/1R96614/1R96614_AVTOSERV30_4pgnl9opb4
- Пользователь 1С: Администратор (без пароля)
- Конфигурация: Альфа-Авто (автосервис)

### Ограничения Rent1C
- CMD/PowerShell отключены
- Установка программ заблокирована
- Нет прав администратора
- Правая кнопка мыши отключена

## Что сделано

1. TIPO-STO развёрнут на 147.45.98.69:8000
2. UI с формами создания/редактирования заказ-нарядов готов
3. VPN к Rent1C работает (172.22.x.x сеть доступна)
4. Веб-интерфейс 1С доступен через VPN

## Что нужно для завершения

### Вариант 1: OData от Rent1C (рекомендуется)
Попросить поддержку Rent1C включить стандартный интерфейс OData для базы.
После включения API будет доступен по адресу:
```
http://172.22.0.89/1R96614/1R96614_AVTOSERV30_4pgnl9opb4/odata/standard.odata/
```

### Вариант 2: Полный доступ от Rent1C
Попросить включить PowerShell/CMD на терминальном сервере для установки Python и API Gateway.

### Вариант 3: Свой сервер с 1С
Арендовать VPS, купить лицензию 1С, установить платформу и подключить через COM-соединение (как было на удалённом 185.222.161.252).

## Файлы проекта

- `/Users/khatlamadzieva/tipo-sto/src/main.py` - TIPO-STO приложение
- `/Users/khatlamadzieva/tipo-sto/api_gateway_v2.py` - API Gateway для COM-соединения (для варианта 3)
- `C:\tipoSTO\main.py` на 147.45.98.69 - развёрнутое приложение
- `C:\tipoSTO\1Cv8.dt` на 147.45.98.69 - выгрузка базы 1С (328 МБ)

## Команды для запуска TIPO-STO

```bash
# SSH на сервер
ssh Administrator@147.45.98.69

# Запуск TIPO-STO
cd C:\tipoSTO
"C:\Program Files\Python312\python.exe" -m uvicorn main:app --host 0.0.0.0 --port 8000
```

## Автозапуск
Настроен через Task Scheduler: задача "TIPO-STO" запускает сервис при старте системы.

## Контакты поддержки Rent1C
- Личный кабинет: через приложение Rent1C
- Нужно запросить: включение стандартного интерфейса OData
